<% @body_id = "products" %>

<section class="main">
<div class="inner group">

	<aside>
	  <h4 class="toggler"><a href="#">Navigation</a></h4>
	  <nav>
		  <h4><a href="#">Messages</a></h4>
		  <h4><a href="#">Orders</h4>
		  <ul>
		  	<li><a href="#">Current Orders</a></li>
		  	<li><a href="#">Past Orders</a></li>
		  </ul>
		  <h4><a href="#">My Account</a></h4>
		  <ul>
		  	<li><%= link_to 'Find Farms', locations_path %></li>
		  	<li><%= link_to 'Shopping List', new_product_path %></li>
		  	<li><a href="#">Edit Profile</a></li>
		  	<li><a href="#">View Profile</a></li>
		  </ul>
		</nav>
	</aside>
	
	<div class="major">
		<h2>Listing Products</h2>
		<div class="content">
			<%= search_form_for @q do |f| %>
			  <%= hidden_field params[:cat], "cat" %>
			  <%= f.label :product_attribute_or_name_cont, "Product Name" %>
			  <%= f.text_field :product_attribute_or_name_cont %> 
			  <%= f.submit %>
			<% end %>
			<table>
				<thead>
					<tr>
						<th>Product</th>
						<th>Variety</th>
						<th>Description</th>
						<th>Packaging</th>
						<th>Pkg. Qty</th>
						<th>Unit Price</th>
						<th>Qty Avail.</th>
						<th>Farm</th>
						<% if @user.business == 'Restaurant' %>
						<th>Order Qty</th>
						<% end %>
						<th></th>
					</tr>
				</thead>
				<tbody>
				<% @products.each do |product| %>
					<tr>
						<td data-heading="Product"><%= product.name %></td>
						<td data-heading="Variety"><%= link_to "#{product.product_attribute}", products_path(:cat => product.product_attribute) %></td>
						<td data-heading="Description"><%= product.description %></td>
						<td data-heading="Packaging"><%= product.packaging %></td>
						<td data-heading="Pkg. Qty"><%= product.uom %></td>
						<td data-heading="Unit Price"><%= number_to_currency(product.price) %></td>
						<td data-heading="Qty Avail."><%= product.qty_avail %></td>
						<td data-heading="Farm"><%= product.user.business_name %>
						<% if @user.business == 'Farm' %>
						<td data-heading="Order Qty"><%= link_to 'Show', product %></td>
						<td data-heading="Product"><%= link_to 'Edit', edit_product_path(product) %></td>
						<td data-heading="Product"><%= link_to 'Destroy', product, method: :delete, data: { confirm: 'Are you sure?' } %></td>
						<% else %>
						<td data-heading="Order Qty"><%= number_field_tag :qty_ordered %></td>
						<td><%= button_to 'Order', order_items_path(product_id: product), :class => 'small-btn order' %>
						<% end %>
					</tr>
					<% end %>
				</tbody>
			</table>
		</div>
	</div>
	
</div>
</section>